"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"GoogleScript",{enumerable:!0,get:function(){return s}});const e=require("googleapis"),t=require("./googleAuth.js");function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s{async init(){let t=await this.googleAuth.authorize();this.service=e.google.script({version:"v1",auth:t})}constructor({user:e="bigwhitekmc",type:s="oauth2",sn:o=0,scopeDir:r="Apis/google/spec",authDir:a="Apis/google"}={}){i(this,"auth",void 0),i(this,"service",void 0),i(this,"googleAuth",void 0),i(this,"runScript",async e=>{await this.service.scripts.run({auth:this.auth,requestBody:{function:"writeToSheet"},scriptId:e})}),i(this,"createScript",async(e,t)=>{let i=await this.service.projects.create({requestBody:{title:"ScriptByTypeScript"}});await this.service.projects.updateContent({auth:this.auth,scriptId:i.data.scriptId,requestBody:{files:[{name:"hello",type:"SERVER_JS",source:'function helloWorld() {\n  console.log("Hello, world!");\n}'},{name:"appsscript",type:"JSON",source:'{"timeZone":"Asia/Seoul","exceptionLogging":"CLOUD"}'},{name:"README",type:"HTML",source:"<HTML><BODY>readme!</BODY></HTML>"}]}})}),i(this,"addFile",async(e,t,i,s)=>{await this.service.projects.updateContent({auth:this.auth,scriptId:e,requestBody:{files:[{name:t,type:i,source:s}]}})}),i(this,"addFiles",async(e,t)=>{await this.service.projects.updateContent({auth:this.auth,scriptId:e,requestBody:{files:t}})}),this.googleAuth=new t.GoogleAuth({user:e,type:s,sn:o,scopeDir:r,authDir:a}),this.auth=this.googleAuth.authorize()}}