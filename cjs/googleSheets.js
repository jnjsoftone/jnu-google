"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(exports,{GoogleSheets:function(){return h},arrToCell:function(){return r},cellToArr:function(){return a}});const e=require("googleapis"),t=require("./googleAuth.js");function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=(e=[2,4])=>{let t=[`${e[0]}`],s=e[1]-1;for(;s>=0;)t.unshift(String.fromCharCode(s%26+65)),s=Math.floor(s/26)-1;return t.join("")},a=(e="A1")=>{if(Array.isArray(e))return e;let[t,s,r]=e.toUpperCase().match(/([A-Z]+)([0-9]+)/),a=0;return s.split("").forEach(e=>{a*=26,a+=e.charCodeAt(0)-65+1}),[parseInt(r),a]},i=(e=[3,2],t=[1,2])=>`${r(e)}:${r([e[0]+t[0],e[1]+t[1]])}`,o=e=>parseInt(e,16)/255,d=e=>({red:o(e.slice(1,3)),green:o(e.slice(3,5)),blue:o(e.slice(5,7))}),n=e=>({style:e.style,color:d(e.color)});class h{async init(){let t=await this.googleAuth.authorize();this.service=e.google.sheets({version:"v4",auth:t})}constructor(e,{user:r="bigwhitekmc",type:o="oauth2",sn:h=0,scopeDir:l="Apis/google/spec",authDir:p="Apis/google"}){s(this,"service",void 0),s(this,"googleAuth",void 0),s(this,"spreadsheetId",void 0),s(this,"getSheetNames",async(e=!1)=>{let t=await this.service.spreadsheets.get({spreadsheetId:this.spreadsheetId}),s=t.data?.sheets?.map(e=>e?.properties?.title);return e?s:s?.filter(e=>!e?.startsWith("_"))}),s(this,"getSheetId",async e=>{let t=(await this.service.spreadsheets.get({spreadsheetId:this.spreadsheetId,fields:"sheets.properties"})).data.sheets;if(!t)return"";let s=t.find(t=>t.properties.title===e);if(!s)throw Error(`Sheet ${e} not found.`);return s.properties.sheetId}),s(this,"getValues",async({range:e="",sheetName:t=""})=>{let s=await this.service.spreadsheets.values.get({spreadsheetId:this.spreadsheetId,range:e?`${t}!${e}`:t}),r=await s.data.values;if(r&&0!==r.length)return r}),s(this,"setValues",async({values:e=[[]],start:t="A1",sheetName:s="",valueInputOption:r="USER_ENTERED"})=>{let o=i(a(t),[e.length,e[0].length]);await this.service.spreadsheets.values.update({spreadsheetId:this.spreadsheetId,range:o?`${s}!${o}`:s,valueInputOption:r,requestBody:{values:e}})}),s(this,"appendValues",async({values:e=[[]],start:t="A1",sheetName:s="",valueInputOption:r="USER_ENTERED"})=>{let o=i(a(t),[e.length,e[0].length]);await this.service.spreadsheets.values.append({spreadsheetId:this.spreadsheetId,range:o?`${s}!${o}`:s,valueInputOption:r,requestBody:{values:e}})}),s(this,"rangeObject_",async(e,t)=>({sheetId:await this.getSheetId(e),startRowIndex:t[0],endRowIndex:t[2],startColumnIndex:t[1],endColumnIndex:t[3]})),s(this,"setRowHeights",async({startRowIndex:e=0,endRowIndex:t=10,height:s=20,sheetName:r=""})=>{let a={updateDimensionProperties:{range:{sheetId:await this.getSheetId(r),dimension:"ROWS",startIndex:e,endIndex:t+1},properties:{pixelSize:s},fields:"pixelSize"}};await this.service.spreadsheets.batchUpdate({spreadsheetId:this.spreadsheetId,requestBody:{requests:[a]}})}),s(this,"setColumnWidths",async({startColumnIndex:e=0,endColumnIndex:t=10,width:s=100,sheetName:r=""})=>{let a={updateDimensionProperties:{range:{sheetId:await this.getSheetId(r),dimension:"COLUMNS",startIndex:e,endIndex:t+1},properties:{pixelSize:s},fields:"pixelSize"}};await this.service.spreadsheets.batchUpdate({spreadsheetId:this.spreadsheetId,requestBody:{requests:[a]}})}),s(this,"setVerticalAlign",async({range:e=[0,0,100,100],sheetName:t,wrapStrategy:s="WRAP",verticalAlignment:r="middle"})=>{let a={repeatCell:{range:await this.rangeObject_(t,e),cell:{userEnteredFormat:{wrapStrategy:s,verticalAlignment:r}},fields:"userEnteredFormat.wrapStrategy,userEnteredFormat.verticalAlignment"}};await this.service.spreadsheets.batchUpdate({spreadsheetId:this.spreadsheetId,requestBody:{requests:[a]}})}),s(this,"setBasicFormat",async({range:e=[0,0,100,100],sheetName:t,horizontalAlignment:s="left",fontSize:r=10,bold:a=!1,backgroundColor:i="#ffffff",foregroundColor:o="#000000"})=>{let n={repeatCell:{range:await this.rangeObject_(t,e),cell:{userEnteredFormat:{backgroundColor:d(i),horizontalAlignment:s,textFormat:{foregroundColor:d(o),fontSize:r,bold:a}}},fields:"userEnteredFormat(backgroundColor,textFormat,horizontalAlignment)"}};await this.service.spreadsheets.batchUpdate({spreadsheetId:this.spreadsheetId,requestBody:{requests:[n]}})}),s(this,"setBorders",async({range:e=[0,0,100,100],sheetName:t="",top:s={style:"SOLID",color:"#ff0000"},bottom:r={style:"SOLID",color:"#0000ff"},left:a={style:"SOLID",color:"#00ff00"},right:i={style:"SOLID",color:"#000000"},innerHorizontal:o={style:"SOLID",color:"#000000"},innerVertical:d={style:"SOLID",color:"#000000"}})=>{let h={updateBorders:{range:await this.rangeObject_(t,e),top:n(s),bottom:n(r),left:n(a),right:n(i),innerHorizontal:n(o),innerVertical:n(d)}};await this.service.spreadsheets.batchUpdate({spreadsheetId:this.spreadsheetId,requestBody:{requests:[h]}})}),this.googleAuth=new t.GoogleAuth({user:r,type:o,sn:h,scopeDir:l,authDir:p}),this.spreadsheetId=e}}