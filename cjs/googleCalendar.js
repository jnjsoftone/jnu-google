"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"GoogleCalendar",{enumerable:!0,get:function(){return i}});const e=require("googleapis"),t=require("./googleAuth.js");function a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class i{async init(){let t=await this.googleAuth.authorize();this.service=e.google.calendar({version:"v3",auth:t})}constructor({user:e="bigwhitekmc",type:i="oauth2",sn:s=0,scopeDir:n="Apis/google/spec",authDir:o="Apis/google"}={}){a(this,"service",void 0),a(this,"googleAuth",void 0),a(this,"listCalendars",async()=>{let e=await this.service,t=(await e.calendarList.list()).data.items;if(!t||0===t.length){console.log("No calendars found.");return}console.log("Calendars:"),t.forEach(e=>{console.log(`${e.id} - ${e.summary}`)})}),a(this,"listEvents",async()=>{let e=await this.service,t=(await e.events.list({calendarId:"primary",timeMin:new Date().toISOString(),maxResults:10,singleEvents:!0,orderBy:"startTime"})).data.items;if(!t||0===t.length){console.log("No upcoming events found.");return}console.log("Upcoming 10 events:"),t.map((e,t)=>{let a=e.start.dateTime||e.start.date;console.log(`${a} - ${e.summary}`)})}),a(this,"createEvent",async(e,t,a)=>{let i=await this.service,s={summary:e,start:{dateTime:t.toISOString()},end:{dateTime:a.toISOString()}},n=await i.events.insert({calendarId:"primary",requestBody:s});console.log(`Event created: ${n.data.htmlLink}`)}),a(this,"updateEvent",async(e,t,a,i)=>{let s=await this.service,n={summary:t,start:{dateTime:a.toISOString()},end:{dateTime:i.toISOString()}},o=await s.events.update({calendarId:"primary",eventId:e,requestBody:n});console.log(`Event updated: ${o.data.htmlLink}`)}),a(this,"deleteEvent",async e=>{let t=await this.service;await t.events.delete({calendarId:"primary",eventId:e}),console.log(`Event deleted: ${e}`)}),this.googleAuth=new t.GoogleAuth({user:e,type:i,sn:s,scopeDir:n,authDir:o})}}