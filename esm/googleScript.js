function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}import{google as e}from"googleapis";import{GoogleAuth as i}from"./googleAuth.js";export class GoogleScript{async init(){let t=await this.googleAuth.authorize();this.service=e.script({version:"v1",auth:t})}constructor({user:e="bigwhitekmc",type:s="oauth2",sn:o=0,scopeDir:r="",authDir:a=""}={}){t(this,"auth",void 0),t(this,"service",void 0),t(this,"googleAuth",void 0),t(this,"runScript",async t=>{await this.service.scripts.run({auth:this.auth,requestBody:{function:"writeToSheet"},scriptId:t})}),t(this,"createScript",async(t,e)=>{let i=await this.service.projects.create({requestBody:{title:"ScriptByTypeScript"}});await this.service.projects.updateContent({auth:this.auth,scriptId:i.data.scriptId,requestBody:{files:[{name:"hello",type:"SERVER_JS",source:'function helloWorld() {\n  console.log("Hello, world!");\n}'},{name:"appsscript",type:"JSON",source:'{"timeZone":"Asia/Seoul","exceptionLogging":"CLOUD"}'},{name:"README",type:"HTML",source:"<HTML><BODY>readme!</BODY></HTML>"}]}})}),t(this,"addFile",async(t,e,i,s)=>{await this.service.projects.updateContent({auth:this.auth,scriptId:t,requestBody:{files:[{name:e,type:i,source:s}]}})}),t(this,"addFiles",async(t,e)=>{await this.service.projects.updateContent({auth:this.auth,scriptId:t,requestBody:{files:e}})}),this.googleAuth=new i({user:e,type:s,sn:o,scopeDir:r,authDir:a}),this.auth=this.googleAuth.authorize()}}